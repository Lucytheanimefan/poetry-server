Theresa May is having a week from hell
Carole Walker is a political analyst who worked as a political news correspondent for the BBC. The opinions in this article belong solely to the author.

(CNN) Theresa May, the British Prime Minister, is preparing for a series of crunch votes in Parliament as she battles opponents on all sides.

This has been a particularly rocky week, even for a government that has looked precarious ever since May lost her overall majority in a general election a year ago.

The proposal has already been rejected by the EU's chief negotiator and is seen as unworkable by some in her own Cabinet. Add to this, there are rumors that the Brexit Secretary who is leading the government's negotiations could resign.

Key decisions on Brexit are looming after Parliament's upper house -- the House of Lords -- inflicted a series of damaging defeats , which ministers have vowed to overturn. The process looks set to expose the deep divisions within her own Cabinet and her governing Conservative Party over the UK's future relationship with the EU.

The Prime Minister has set a "red line" that the UK will leave the EU customs union after Brexit -- but the Lords voted overwhelmingly to stay in.

Ministers have vowed to reverse the vote when the legislation returns to the House of Commons in the next few weeks. But a rebellion by just a handful of May's Conservative MPs could defeat the government on a key plank of its Brexit strategy.

The upper house also voted to give Parliament a big say on any final Brexit deal, rather than leaving it to the government alone.

Ministers say this would tie their hands in the negotiations, making it impossible to threaten to walk away without agreement if they don't like what they are offered.

They have pledged to overturn this measure too, but it will not be easy to convince the Commons to limit its role in the Brexit process.

JUST WATCHED How Brexit could end flights in and out the UK Replay More Videos ... MUST WATCH How Brexit could end flights in and out the UK 03:30

There is still no solution to the problem of the Irish border, no agreement on how to avoid any hard infrastructure when Northern Ireland is outside the EU and the Irish republic remains inside it.

The resignation of the Home Secretary Amber Rudd in the midst of a huge row over immigration was a serious blow to the government. She is the fourth Cabinet minister to be forced out in the past six months and leaves the Prime Minister struggling to explain her own role in establishing what she called a "hostile environment" for illegal immigrants.

Rudd decided to step down after admitting she had "inadvertently misled" a parliamentary committee about targets for removing illegal immigrants from the UK.

She told MPs that her department did not have targets, but leaked documents showed not only that targets did exist, but that Rudd herself had written to the Prime Minister setting out her aim of increasing enforced removals by more than 10% over the next few years.

She had already been made to apologize, several times, for the government's treatment of "the Windrush generation." Named after the ship which brought some of them to the UK from the Caribbean, these were Commonwealth citizens entitled to settle in the UK.

But some were threatened with deportation or lost their jobs -- after decades living in Britain -- when the law was changed and they were asked to show documents, which many did not possess. This was part of what was called a "hostile environment" for illegal immigrants and many of the policies were introduced by the previous Home Secretary: May.

The opposition Labour Party says Rudd had only been kept in her post as the scandal unfolded because she was a "human shield" protecting the Prime Minister. Now they are turning their fire on May, saying she is the "architect of the crisis."

The Prime Minister has suffered a bruising week and is facing a series of apparently intractable problems. But Theresa May has displayed extraordinary resilience and defied many previous predictions that she cannot survive.

There is no doubt that she has been helped by the fact that none of her potential successors wants her job at the moment. Perhaps that is not surprising, given the politically hostile environment confronting her government.